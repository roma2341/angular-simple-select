<div cdkOverlayOrigin #trigger="cdkOverlayOrigin" class="select-wrapper" (click)="openDropdown()" tabindex="0">
  @if (!multiValue()?.length && !value()) {
    <div class="select-placeholder">
      {{ placeholder() }}
    </div>
  } @else {
    <div class="select-value-wrapper">
      @let selectedOptionVal = selectedOption();
      <div class="select-value">
        @if (multiple()) {
          <ngx-select-zigzag-multivalue
            [items]="selectedOptions()"
            [labelKey]="labelKey()"
            [valueKey]="valueKey()"
            [itemTemplate]="multiValueItemTemplate()"
          ></ngx-select-zigzag-multivalue>
        } @else if (selectedOptionVal) {
          {{ selectedOptionVal | selectorOptionLabel: labelKey() }}
        }
      </div>
      @if (!isOptionsDropDownOpen()) {
        <div class="clear-icon-wrapper">
          <div (click)="$event.stopPropagation(); clearValue()" class="clear-icon"></div>
        </div>
      }
    </div>
  }
  <ng-template #overlayTemplate>
    <div class="options-dropdown">
      <div class="options-dropdown-header">
        @if (multiple()) {
          Select options
        } @else {
          Select option
        }
        <ngx-select-zigzag-form-field>
          <input #searchInputRef (keyup)="inputKeyUp(searchInputRef.value, $event)" />
        </ngx-select-zigzag-form-field>
      </div>
      <cdk-virtual-scroll-viewport [itemSize]="34" class="options-viewport">
        <div *cdkVirtualFor="let option of filteredOptions()" class="example-item">
          <div class="options-dropdown-item" (click)="selectOption(option)" [class.selected]="isSelected(option)">
            @if (optionTemplate()) {
              <ng-container *ngTemplateOutlet="optionTemplate; context: { $implicit: option }"></ng-container>
            } @else {
              <input type="checkbox" [checked]="isSelected(option)" />
              <span>
                {{ option | selectorOptionLabel: labelKey() }}
              </span>
            }
          </div>
        </div>
      </cdk-virtual-scroll-viewport>
    </div>
  </ng-template>
</div>
